
# Домашнее задание к занятию «Микросервисы: принципы»

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: API Gateway 

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- маршрутизация запросов к нужному сервису на основе конфигурации,
- возможность проверки аутентификационной информации в запросах,
- обеспечение терминации HTTPS.

Обоснуйте свой выбор.

## Ответ


| Возможности | WSO2 | NGINX  | Kong | Traefik   | HAProxy | Envoy | 
|-|---------|--------------------|------|-----------|---------|---------|
| маршрутизация к сервису на основе конфигурации | + | + | + | + | + | + |
| JWT-валидация | + | - | +| - | + | +|
| аутентификация в запросе | + | Basic only | + | + | +| + |
| терминация HTTPS | + | + | + | +  | + | + |
| Звёзды на GitHub  | 797 | 20k | 37.1k | 47.1k | 4.3k | 23.6k |

Решений сейчас довольно много, сюда можно было бы добавить и Tyk, и Apigee, и Zuul и т.д.
Выбор зависит от принятых в компании практик и реализации инфраструктуры.
Здесь мало полагаться на личные предпочтения или популярность.
Например в организации где я работаю, в силу своих причин используется WSO2 (поэтому включил его в таблицу, несмотря на очень низкий рейтинг на github решение неплохое).
В сети и каналах телеграм я вижу все более возрастающую популярность Envoy, также очень распрстранен Traefik.

 

## Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- поддержка кластеризации для обеспечения надёжности,
- хранение сообщений на диске в процессе доставки,
- высокая скорость работы,
- поддержка различных форматов сообщений,
- разделение прав доступа к различным потокам сообщений,
- простота эксплуатации.

Обоснуйте свой выбор.

## Ответ

| Брокер сообщений | Поддержка кластеризации | Хранение сообщений на диске | Высокая скорость работы | Поддержка различных форматов сообщений | Разделение прав доступа | Простота эксплуатации |
|------------------|-------------------------|-----------------------------|-------------------------|----------------------------------------|------------------------|-----------------------|
| Apache Kafka     | Да                      | Да                          | Да                      | Да                                     | Да                     | Нет                   |
| RabbitMQ         | Да                      | Да                          | Да                      | Да                                     | Да                     | Да                    |
| ActiveMQ         | Да                      | Да                          | Да                      | Да                                     | Да                     | Нет                   |


На основе сравнительной таблицы, учитывая  требования, я бы рекомендовал Apache Kafka. Опять же этот MQ также используется в организации где я сейчас работаю. Поддерживается:

1. Кластеризация для обработки больших объемов сообщений и обеспечения высокой доступности.
   
2. Можно сохранять сообщения на диске в процессе доставки, что обеспечивает сохранность данных в случае сбоев.

3. Высокая производительность и способность обрабатывать большие потоки данных в реальном времени.

4. Позволяется работать с различными форматами сообщений, такими как JSON, Avro и другие.

5. Поддержка разделения прав доступа, организация доступа к различным потокам сообщений в соответствии с требованиями безопасности.

6. Простоста эксплуатации - да, но потребует нароботки определенного опыта работы с Kafka.

## Задача 3: API Gateway * (необязательная)


---
